<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Thenux-AI — Futuristic Robot Chat</title>
<link rel="icon" href="data:image/svg+xml;utf8,
  <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'>
    <rect width='64' height='64' rx='14' fill='%23111' />
    <path d='M16 34q0-10 16-10t16 10v8q0 4-4 6l-4 3H24l-4-3q-4-2-4-6z' fill='%23a7f3d0'/>
    <circle cx='28' cy='34' r='3' fill='%2300ffd5'/>
    <circle cx='36' cy='34' r='3' fill='%2300ffd5'/>
  </svg>">
<style>
  :root{
    --bg:#0b1220;
    --bg-deep:#070d19;
    --card:#0f172a;
    --muted:#94a3b8;
    --text:#e5f0ff;
    --accent:#00ffd5;
    --accent-2:#6aa6ff;
    --danger:#ff6b6b;
    --glass:rgba(255,255,255,.06);
    --ring:0 0 0 2px rgba(0,255,213,.3), 0 20px 80px rgba(0,0,0,.6);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;background: radial-gradient(1200px 800px at 70% -20%, #112043 0%, var(--bg) 45%, var(--bg-deep) 100%);
    color:var(--text);font:500 16px/1.6 Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,Helvetica,Arial;
    overflow:hidden;
  }

  /* ---------- Intro Overlay ---------- */
  .intro{
    position:fixed; inset:0; display:grid; place-items:center;
    background: radial-gradient(600px 400px at 50% -10%, #1d2a44 0%, #0c162a 40%, #060b16 100%);
    z-index:40; transition:opacity .8s ease, transform .8s ease; will-change:opacity,transform;
  }
  .intro.hide{opacity:0; pointer-events:none; transform:scale(1.02)}
  .intro .stage{
    position:relative; width:min(720px,90vw); aspect-ratio:16/9;
    border-radius:28px; background:#0e1a2b; box-shadow:0 20px 60px rgba(0,0,0,.5) inset, 0 8px 80px rgba(0,0,0,.5);
    display:grid; place-items:center; overflow:hidden;
  }
  .intro .click-text{
    position:absolute; inset:0; display:grid; place-items:center;
    font-size:min(16vw,150px); letter-spacing:.06em; font-weight:900;
    color:#1c2a41; user-select:none; pointer-events:none;
  }
  .intro canvas{width:42%; max-width:280px; aspect-ratio:1/1; filter:drop-shadow(0 10px 30px rgba(0,255,213,.25))}
  .click-tip{
    position:absolute; bottom:22px; left:50%; transform:translateX(-50%);
    font-size:14px; color:var(--muted); letter-spacing:.16em; text-transform:uppercase;
    background:rgba(255,255,255,.04); padding:10px 14px; border-radius:999px; backdrop-filter:blur(6px);
    border:1px solid rgba(255,255,255,.08)
  }

  /* ---------- App Shell ---------- */
  .app{position:fixed; inset:0; display:grid; grid-template-rows:auto 1fr auto; opacity:0; pointer-events:none; transition:opacity .6s ease}
  .app.ready{opacity:1; pointer-events:auto}

  /* Top bar */
  .topbar{
    height:64px; display:flex; align-items:center; gap:14px; padding:0 18px;
    background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
    border-bottom:1px solid rgba(255,255,255,.06); backdrop-filter:blur(10px);
  }
  .logo{
    width:40px; height:40px; border-radius:12px; background:linear-gradient(135deg, var(--accent), #2dffe7 30%, #9cf4ff 100%);
    box-shadow:0 6px 30px rgba(0,255,213,.35);
    position:relative;
  }
  .logo::after{
    content:""; position:absolute; inset:4px; border-radius:10px; background:var(--bg-deep)
  }
  .brand{display:flex; flex-direction:column}
  .brand b{font-size:18px; letter-spacing:.4px}
  .brand span{font-size:12px; color:var(--muted)}

  /* Main */
  .main{position:relative; display:grid; grid-template-columns:320px 1fr; gap:18px; padding:18px; overflow:hidden}
  @media (max-width:980px){ .main{grid-template-columns:1fr} }

  /* Sidebar card */
  .card{
    background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
    border:1px solid rgba(255,255,255,.06); border-radius:24px; box-shadow:var(--ring);
    overflow:hidden
  }
  .side{padding:18px}
  .side .title{font-weight:800; letter-spacing:.04em; text-transform:uppercase; font-size:12px; color:var(--muted); margin-bottom:10px}
  .preset{display:flex; flex-wrap:wrap; gap:10px}
  .chip{
    padding:8px 12px; border-radius:999px; background:rgba(255,255,255,.05); border:1px solid rgba(255,255,255,.1);
    cursor:pointer; transition:.2s; font-size:14px
  }
  .chip:hover{transform:translateY(-1px); background:rgba(255,255,255,.07)}
  .credit{margin-top:14px; font-size:12px; color:var(--muted)}
  .credit a{color:var(--accent)}

  /* Chat area */
  .chat{display:flex; flex-direction:column; height:100%}
  .messages{flex:1; padding:20px; overflow:auto; scroll-behavior:smooth}
  .bubble{
    max-width:860px; padding:14px 16px; margin:8px 0; border-radius:16px; line-height:1.55;
    background:rgba(255,255,255,.04); border:1px solid rgba(255,255,255,.08); backdrop-filter:blur(8px)
  }
  .bubble.user{ margin-left:auto; border-top-right-radius:6px; background:linear-gradient(135deg, rgba(0,255,213,.14), rgba(255,255,255,.06))}
  .bubble.bot{ margin-right:auto; border-top-left-radius:6px}
  .typing{display:inline-block; width:8px; height:8px; border-radius:50%; background:rgba(255,255,255,.7); box-shadow:12px 0 0 rgba(255,255,255,.6), 24px 0 0 rgba(255,255,255,.5); animation:blink .9s infinite}
  @keyframes blink{ 0%{opacity:.2} 50%{opacity:1} 100%{opacity:.2} }

  /* Composer */
  .composer{
    display:flex; gap:10px; padding:14px; background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
    border-top:1px solid rgba(255,255,255,.06); backdrop-filter:blur(10px)
  }
  .input{
    flex:1; display:flex; gap:10px; align-items:center; background:rgba(255,255,255,.05); border:1px solid rgba(255,255,255,.1);
    border-radius:18px; padding:10px 12px
  }
  .input input{
    flex:1; background:transparent; border:0; outline:0; color:var(--text); font-size:16px
  }
  .btn{
    padding:10px 14px; border-radius:14px; border:1px solid rgba(255,255,255,.14); background:linear-gradient(135deg, var(--accent), var(--accent-2));
    color:#04151f; font-weight:800; letter-spacing:.03em; cursor:pointer; transition:transform .08s ease, filter .2s ease
  }
  .btn:active{ transform:translateY(1px) }
  .ghost-btn{
    padding:9px 12px; border-radius:12px; border:1px dashed rgba(255,255,255,.2); background:transparent; color:var(--text); cursor:pointer
  }

  /* Background canvases */
  canvas#bg, canvas#bot{position:fixed; inset:0; z-index:-1}
  canvas#bot{inset:auto auto 18px 18px; width:220px; height:220px; z-index:0; opacity:.9; pointer-events:none}
  @media (max-width:980px){ canvas#bot{width:150px; height:150px; left:12px; bottom:12px} }

  /* Utility */
  .row{display:flex; align-items:center; gap:10px}
  .muted{color:var(--muted)}
</style>
</head>
<body>

<!-- Particle background -->
<canvas id="bg"></canvas>

<!-- Intro -->
<section class="intro" id="intro">
  <div class="stage">
    <div class="click-text">CLICK</div>
    <canvas id="introBot" width="420" height="420" aria-label="Click the robot to enter"></canvas>
    <div class="click-tip">Tap the robot to launch Thenux-AI</div>
  </div>
</section>

<!-- App -->
<section class="app" id="app">
  <header class="topbar">
    <div class="logo"></div>
    <div class="brand">
      <b>Thenux-AI</b>
      <span>Futuristic AI Assistant • Powered by Gemini endpoint</span>
    </div>
    <div style="margin-left:auto" class="row">
      <button class="ghost-btn" id="clearBtn" title="Clear chat">Clear</button>
      <button class="ghost-btn" id="pulseBtn" title="Robot pulse">Pulse</button>
    </div>
  </header>

  <main class="main">
    <aside class="card side">
      <div class="title">Quick prompts</div>
      <div class="preset" id="presets">
        <div class="chip" data-q="Summarize this page in 5 bullet points.">Summary (5 bullets)</div>
        <div class="chip" data-q="Write a friendly greeting in Sinhala for my website visitors.">Sinhala Greeting</div>
        <div class="chip" data-q="Generate modern HTML/CSS for a glowing button component.">Glowing Button Code</div>
        <div class="chip" data-q="Give me 3 creative marketing taglines for a futuristic browser named Thenux.">Thenux Taglines</div>
      </div>
      <div class="credit">
        Endpoint: <code>api.bk9.dev/ai/gemini</code><br/>
        Credit: <b>Thenula Panapiti</b> • Thenux-AI
      </div>
    </aside>

    <section class="card chat">
      <div class="messages" id="messages"></div>

      <div class="composer">
        <div class="input">
          <input id="prompt" placeholder="Ask anything… (press Enter)" autocomplete="off" />
          <button class="btn" id="sendBtn">Send</button>
        </div>
      </div>
    </section>
  </main>
</section>

<!-- Floating live robot -->
<canvas id="bot" width="500" height="500"></canvas>

<script>
/* ===================== Particle Background ===================== */
(function(){
  const c = document.getElementById('bg'), x = c.getContext('2d');
  function size(){ c.width=innerWidth; c.height=innerHeight }
  size(); addEventListener('resize', size);
  const N = 90, pts=[];
  for(let i=0;i<N;i++){
    pts.push({x:Math.random()*c.width, y:Math.random()*c.height,
              vx:(Math.random()-.5)*.6, vy:(Math.random()-.5)*.6, r:Math.random()*2+0.6});
  }
  function step(){
    x.clearRect(0,0,c.width,c.height);
    for(const p of pts){
      p.x+=p.vx; p.y+=p.vy;
      if(p.x<0||p.x>c.width) p.vx*=-1;
      if(p.y<0||p.y>c.height) p.vy*=-1;
      x.beginPath(); x.arc(p.x,p.y,p.r,0,Math.PI*2);
      x.fillStyle="rgba(0,255,213,.55)"; x.fill();
    }
    // links
    for(let i=0;i<N;i++){
      for(let j=i+1;j<N;j++){
        const a=pts[i], b=pts[j];
        const dx=a.x-b.x, dy=a.y-b.y, d=Math.hypot(dx,dy);
        if(d<120){
          x.strokeStyle="rgba(108,158,255,"+(1-d/120)*.25+")";
          x.lineWidth=1; x.beginPath(); x.moveTo(a.x,a.y); x.lineTo(b.x,b.y); x.stroke();
        }
      }
    }
    requestAnimationFrame(step);
  }
  step();
})();

/* ===================== Robot Drawing (Canvas) ===================== */
function drawRobot(ctx, t=0, bobAmt=8, eyeGlow=1){
  const W = ctx.canvas.width, H = ctx.canvas.height;
  ctx.clearRect(0,0,W,H);
  ctx.save();
  const bob = Math.sin(t/600)*bobAmt;
  ctx.translate(W/2, H/2 + bob);

  // Body shadow
  ctx.shadowColor = "rgba(0,0,0,.35)";
  ctx.shadowBlur = 20;

  // Helmet
  ctx.beginPath();
  ctx.moveTo(-120, 10); ctx.quadraticCurveTo(-140,-80, 0,-110);
  ctx.quadraticCurveTo(140,-80, 120, 10); ctx.quadraticCurveTo(80,60, -80,60);
  ctx.quadraticCurveTo(-120,40,-120,10);
  const grad = ctx.createLinearGradient(-140,-110,140,60);
  grad.addColorStop(0,"#172842");
  grad.addColorStop(.5,"#0f1c31");
  grad.addColorStop(1,"#0a1526");
  ctx.fillStyle = grad; ctx.fill();
  ctx.lineWidth=3; ctx.strokeStyle="rgba(255,255,255,.08)"; ctx.stroke();

  // Visor glass
  ctx.beginPath();
  ctx.moveTo(-90,-10); ctx.quadraticCurveTo(-40,-60, 0,-60);
  ctx.quadraticCurveTo(40,-60, 90,-10);
  ctx.quadraticCurveTo(60,30, -60,30);
  ctx.quadraticCurveTo(-90,10, -90,-10);
  const vis = ctx.createLinearGradient(-100,-60,100,30);
  vis.addColorStop(0,"rgba(0,255,213,.08)");
  vis.addColorStop(1,"rgba(106,166,255,.12)");
  ctx.fillStyle = vis; ctx.fill();

  // Eyes
  ctx.shadowColor = "rgba(0,255,213,.6)";
  ctx.shadowBlur = 18*eyeGlow;
  const blink = Math.abs(Math.sin(t/1300))>.15 ? 1 : 0.15;
  ctx.fillStyle = "#00ffd5";
  ctx.fillRect(-45, -18, 24, 12*blink);
  ctx.fillRect( 21, -18, 24, 12*blink);

  // Mouth grill
  ctx.shadowBlur=0; ctx.fillStyle="#0c1a2b";
  ctx.fillRect(-18, 36, 36, 8);
  ctx.fillStyle="rgba(255,255,255,.06)";
  for(let i=-12;i<=12;i+=6) ctx.fillRect(i, 36, 3, 8);

  // Neck + chest
  ctx.beginPath();
  ctx.moveTo(-60,60); ctx.quadraticCurveTo(0,80,60,60); ctx.quadraticCurveTo(40,110,-40,110); ctx.quadraticCurveTo(-60,90,-60,60);
  ctx.fillStyle="#0b1628"; ctx.fill();

  // Shoulder plates
  ctx.beginPath();
  ctx.moveTo(-120,10); ctx.quadraticCurveTo(-140,90,-80,120); ctx.quadraticCurveTo(-40,130,-20,110);
  ctx.lineTo(20,110); ctx.quadraticCurveTo(40,130,80,120); ctx.quadraticCurveTo(140,90,120,10);
  ctx.fillStyle="#0c172a"; ctx.globalAlpha=.9; ctx.fill(); ctx.globalAlpha=1;

  // Glow ring
  ctx.beginPath();
  ctx.arc(0,120,140,Math.PI*0.88,Math.PI*0.12,false);
  ctx.strokeStyle="rgba(0,255,213,.28)"; ctx.lineWidth=2; ctx.stroke();

  ctx.restore();
}
function animateRobot(canvas){
  const ctx = canvas.getContext('2d');
  let t=0, glow=1, pulse=0;
  function loop(){
    t+=16;
    const g = 1 + Math.sin(pulse)/6;
    drawRobot(ctx, t, 8, glow*g);
    pulse+=0.08;
    requestAnimationFrame(loop);
  }
  loop();
}

/* Intro robot (bigger, clickable) */
(function(){
  const c = document.getElementById('introBot');
  const ctx = c.getContext('2d');
  let t=0;
  function loop(){
    t+=16; drawRobot(ctx, t, 10, 1.2);
    // little hover sparkle
    ctx.save();
    ctx.translate(c.width/2, c.height/2+80+Math.sin(t/400)*6);
    ctx.fillStyle="rgba(0,255,213,.25)";
    ctx.beginPath(); ctx.ellipse(0,120,120,14,0,0,Math.PI*2); ctx.fill();
    ctx.restore();
    requestAnimationFrame(loop);
  }
  loop();
})();

/* ===================== App Logic ===================== */
const intro = document.getElementById('intro');
const app = document.getElementById('app');
const msgEl = document.getElementById('messages');
const promptEl = document.getElementById('prompt');
const sendBtn = document.getElementById('sendBtn');
const clearBtn = document.getElementById('clearBtn');
const pulseBtn = document.getElementById('pulseBtn');
const liveBotCanvas = document.getElementById('bot');

/* Start app on click anywhere inside intro stage */
document.querySelector('.stage').addEventListener('click', () => {
  intro.classList.add('hide');
  app.classList.add('ready');
  animateRobot(liveBotCanvas);
  setTimeout(()=> promptEl.focus(), 400);
});

/* Presets */
document.getElementById('presets').addEventListener('click', e=>{
  const chip = e.target.closest('.chip');
  if(!chip) return;
  promptEl.value = chip.dataset.q;
  promptEl.focus();
});

/* Message helpers */
function addBubble(txt, who='bot'){
  const div = document.createElement('div');
  div.className = `bubble ${who}`;
  div.innerHTML = txt.replace(/\n/g,'<br>');
  msgEl.appendChild(div);
  msgEl.scrollTop = msgEl.scrollHeight;
  return div;
}
function typingBubble(){
  const b = document.createElement('div');
  b.className='bubble bot'; b.innerHTML = '<span class="typing"></span>';
  msgEl.appendChild(b); msgEl.scrollTop = msgEl.scrollHeight;
  return b;
}

/* API call to Gemini proxy */
async function askAI(q){
  const url = 'https://api.bk9.dev/ai/gemini?q=' + encodeURIComponent(q);
  const res = await fetch(url, {method:'GET'});
  if(!res.ok) throw new Error('Network error: '+res.status);
  const data = await res.json();
  if(data && (data.BK9 || data.answer || data.response)){
    return data.BK9 || data.answer || data.response;
  }
  if(data && data.status===true && typeof data.message==='string') return data.message;
  return JSON.stringify(data);
}

/* Send flow */
async function sendPrompt(){
  const q = promptEl.value.trim();
  if(!q) return;
  addBubble(q, 'user');
  promptEl.value='';
  const t = typingBubble();
  try{
    const a = await askAI(q);
    t.remove();
    addBubble(sanitize(a), 'bot');
  }catch(err){
    t.remove();
    addBubble('⚠️ <b>Error:</b> '+sanitize(err.message)+'<br><span class="muted">The API might be busy or blocked by CORS.</span>', 'bot');
  }
}
function sanitize(s){
  return String(s)
    .replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')
    .replace(/\*\*(.+?)\*\*/g,'<b>$1</b>')
    .replace(/`([^`]+)`/g,'<code>$1</code>');
}

/* Events */
sendBtn.addEventListener('click', sendPrompt);
promptEl.addEventListener('keydown', e=>{
  if(e.key==='Enter' && !e.shiftKey){ e.preventDefault(); sendPrompt(); }
});
clearBtn.addEventListener('click', ()=>{
  msgEl.innerHTML='';
  addBubble('👋 Hi there! I’m <b>Thenux-AI</b>. Ask me anything.', 'bot');
});
pulseBtn.addEventListener('click', ()=>{
  // simple pulse by briefly redrawing with stronger glow
  const ctx = liveBotCanvas.getContext('2d');
  let t=0;
  const timer = setInterval(()=>{
    t+=1;
    drawRobot(ctx, performance.now(), 8, 1.6 - Math.min(1, t/12));
    if(t>12) clearInterval(timer);
  }, 16);
});

/* Seed welcome */
addBubble('👋 Hi there! I’m <b>Thenux-AI</b>. Tap the robot to begin.', 'bot');
</script>
</body>
</html>
